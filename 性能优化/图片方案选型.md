# 图片方案选型

摘自[前端性能优化原理与实践](https://juejin.im/book/5b936540f265da0a9624b04b/section/5b98ceb46fb9a05d3154f6bd)

### 简介

> 广泛的 Web 图片格式有 JPEG/JPG、PNG、WebP、Base64、SVG 等类型，每种类型应用的场景各不同。

### 前置知识：二进制位数与色彩的关系

> 在计算机中，像素用二进制数来表示。不同的图片格式中像素与二进制位数之间的对应关系是不同的。一个像素对应的二进制位数越多，它可以表示的颜色种类就越多，成像效果也就越细腻，文件体积相应也会越大。一个二进制位表示两种颜色（0|1 对应黑|白），如果一种图片格式对应的二进制位数有 n 个，那么它就可以呈现 2^n 种颜色。

### JPEG/JPG

> 特点：有损压缩、体积小、加载快、不支持透明
> JPG 最大的特点是有损压缩。这种高效的压缩算法使它成为了一种非常轻巧的图片格式。另一方面，即使被称为“有损”压缩，JPG 的压缩方式仍然是一种高质量的压缩方式：当我们把图片体积压缩至原有体积的 50% 以下时，JPG 仍然可以保持住 60% 的品质。此外，JPG 格式以 24 位存储单个图，可以呈现多达 1600 万种颜色，足以应对大多数场景下对色彩的要求，这一点决定了它压缩前后的质量损耗并不容易被我们人类的肉眼所察觉。

> 适用场景：JPG 适用于呈现色彩丰富的图片，在我们日常开发中，JPG 图片经常作为大的背景图、轮播图或 Banner 图出现
> 缺点：1.有损压缩不适用处理矢量图形和 Logo 等线条感较强、颜色对比强烈的图像；2.不支持透明度处理

### PNG

> 特点：无损压缩、质量高、体积大、支持透明
> PNG（可移植网络图形格式）是一种无损压缩的高保真的图片格式。8 和 24，这里都是二进制数的位数。按照我们前置知识里提到的对应关系，8 位的 PNG 最多支持 256 种颜色，而 24 位的可以呈现约 1600 万种颜色。PNG 图片具有比 JPG 更强的色彩表现力，对线条的处理更加细腻，对透明度有良好的支持。

> 适用场景：呈现小的 Logo、颜色简单且对比强烈的图片或背景、需要处理透明处理
> 缺点：体积太大

### SVG

> 特点：文本文件、体积小、不失真、兼容性好
> SVG（可缩放矢量图形）是一种基于 XML 语法的图像格式。它和本文提及的其它图片种类有着本质的不同：SVG 对图像的处理不是基于像素点，而是是基于对图像的形状描述。SVG 与 PNG 和 JPG 相比，文件体积更小，可压缩性更强。作为矢量图，它最显著的优势还是在于图片可无限放大而不失真这一点上。此外，SVG 是文本文件。我们既可以像写代码一样定义 SVG，把它写在 HTML 里、成为 DOM 的一部分，也可以把对图形的描述写入以 .svg 为后缀的独立文件（SVG 文件在使用上与普通图片文件无异）。这使得 SVG 文件可以被非常多的工具读取和修改，具有较强的灵活性。

> 适用场景：适配手机和 iPad 的移动端项目
> 缺点：1.渲染成本比较高，这点对性能来说是很不利的；2.SVG 存在着其它图片格式所没有的学习成本（它是可编程的）

### base64

> 特点： 文本文件、依赖编码、小图标解决方案
> Base64 并非一种图片格式，而是一种编码方式。Base64 和雪碧图一样，是作为小图标解决方案而存在的。Base64 是一种用于传输 8Bit 字节码的编码方式，通过对图片进行 Base64 编码，我们可以直接将编码结果写入 HTML 或者写入 CSS，从而减少 HTTP 请求的次数（合成雪碧图仍是主要的减少 HTTP 请求的途径，Base64 是雪碧图的补充）。

> 适用场景：1.图片的实际尺寸很小；2.图片无法以雪碧图的形式与其它小图结合；3.图片的更新频率非常低（不需我们重复编码和修改文件内容，维护成本较低）
> 缺点：文件体积膨胀大、以及浏览器解析 Base64 的时间开销大

### WebP

> 特点：支持有损压缩和无损压缩、支持透明
> 与 PNG 相比，WebP 无损图像的尺寸缩小了 26％。在等效的 SSIM 质量指数下，WebP 有损图像比同类 JPEG 图像小 25-34％。 无损 WebP 支持透明度（也称为 alpha 通道），仅需 22％ 的额外字节。对于有损 RGB 压缩可接受的情况，有损 WebP 也支持透明度，与 PNG 相比，通常提供 3 倍的文件大小。

> 适用场景：支持 webp 的浏览器
> 缺点：兼容性不好

### gif

> GIF 图形交换格式是一种位图图形文件格式,以 8 位色（即 256 种颜色，2 的 8 次方）重现真彩色的图像。它实际上是一种压缩文档,采用 LZW 压缩算法进行编码,有效地减少了图像文件在网络上传输的时间。它是目前广泛应用于网络传输的图像格式之一。

> 优点：支持动画
> 缺点：由于采用了 8 位压缩,最多只能处理 256 种颜色，不宜应用于真彩图像。
